<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="stylesheet.css">
    <script src="jquery-2.1.3.js"></script>
    <script>
        function makePipeline(tableid, numRows) {  
            var i;
            for(i = 0; i < numRows; i++){
                var start = getStart(i, numRows);
                var middle = "<td class = '"+tableid+"_"+(i)+"'><img src = 'IM.png' class = 'InstFetchImg'></td><td class = '"+tableid+"_"+(i+1)+"'><img src = 'Reg1.png' class = 'Reg1Img'></td><td class = '"+tableid+"_"+(i+2)+"'><img src = 'ALU.png' class = 'ALUImg'></td><td class = '"+tableid+"_"+(i+3)+"'><img src = 'DM.png' class = 'DMImg'></td><td class = '"+tableid+"_"+(i+4)+"'><img src = 'Reg2.png' class = 'Reg2Img'></td>";
                var end = getEnd(i, numRows);
                $("#"+tableid).append(start+middle+end);
            }
        }
        
        function getStart(it, numRows){
            var s = "<tr>";
            var i;
            for(i = 0; i < it; i++){
                s += "<td></td>";
            }
            return s;
        }
        
        function getEnd(it, numRows){
            var s = "";
            var i;
            var numCols = 5 + numRows - 1;
            for(i = it + 5; i <= numCols; i++){
                s += "<td></td>";
            }
            s += "</tr>";
            return s;
        }
        
        function movePipeline(tableid){
            var i = -1;
            var atEnd = false;
            while(!atEnd){
                i++;
                if($("."+tableid+"_"+i)[0]){
                    $("."+tableid+"_"+i).each(function () {
                        if( !$(this).hasClass("highlight")  ){
                            atEnd = true;
                        }
                    });
                }else{
                    atEnd = true;
                    i = -1;
                }
            }
            if(i != -1){
                $("."+tableid+"_"+i).each(function () {
                    $(this).addClass("highlight");
                });
            }else{
                restartAnimation(tableid);
            }
        }
        
        function restartAnimation(tableid){
            $("#"+tableid+" td").each( function () {
                $(this).removeClass("highlight");
            });
        }
    
       $(document).ready(function (){
            makePipeline("pipeline", 3);
       });
    </script>
</head>

<body>

    <table id = "pipeline" cellspacing = "0" cellpadding = "0" onclick = "movePipeline('pipeline')"></table>

</body>

</html>